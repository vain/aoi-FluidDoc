% Basics
\documentclass[12pt,a4paper]{scrartcl}
\usepackage[ngerman]{babel}
\usepackage[utf8x]{inputenc}

% Grundlegende Pakete
\usepackage{amsmath,amsfonts,amssymb}
\usepackage{graphicx}
\usepackage{color}
\usepackage{hyperref}

% Einfache Anpassungen und PDF-Metadaten
\parindent 0em
\parskip 1em
\definecolor{darkblue}{rgb}{0,0,0.5}
\hypersetup{
	pdftitle={Fluid-Simulation 0.6.6},
	pdfauthor={TroY},
	pdfkeywords={AoI, Physics, Fluid},
	%
	colorlinks=true,
	breaklinks=true,
	linkcolor=black,
	menucolor=darkblue,
	urlcolor=darkblue
}


% Meine sonstigen Sachen
\input{shortcuts}
\input{listings}
\input{pagestyle}

% Befehle nur für dieses Dokument
\input{customcommands}


\begin{document}

% Titelseite mit Copyleft
\author{TroY \\ \url{http://www.uninformativ.de}}
\title{\fluidsim 0.6.6 \\ mit Art of Illusion}
\date{April 2009}
\maketitle
\thispagestyle{empty}

\vspace{100mm}

\begin{center}
	Dieses Dokument steht unter der \\
	\textit{Creative Commons Attribution-Noncommercial-Share Alike 3.0 Germany License}, \\
	\url{http://creativecommons.org/licenses/by-nc-sa/3.0/de/}.

	\includegraphics[scale=0.5]{cc.pdf} \\
	\url{http://creativecommons.org/}
\end{center}

\pagebreak


% Inhaltsverzeichnis
\tableofcontents
\thispagestyle{empty}
\pagebreak


% Dokument

\section{Einleitung}
Bereits seit 2005 arbeitet \deltor an einem Plugin zur Physiksimulation,
was zu Beginn ein reines Plugin für \blender werden sollte. Er entdeckte
dann zwar recht bald, dass in dieser Hinsicht bereits andere
Programmierer an der Arbeit waren, entschied sich aber trotzdem dafür,
sein eigenes Plugin weiterzuentwickeln -- zum Vorteil für die Nutzer von
\aoi. Denn auf unser schönes Programm stieß \deltor erst Anfang 2007.
Der Kern seiner Simulation war seit jeher in Java geschrieben, was der
Integration mit \aoi natürlich sehr entgegen kam. So nahmen die Dinge
dann ihren Lauf.

\deltor's Plugin ist zwar immernoch in einer recht frühen
Entwicklungsphase, aber es ist durchaus schon zu gebrauchen -- und sei
es nur, um Spaß zu haben. Die jeweils aktuelle Version ist in seinem
Blog verlinkt:

\url{http://delt0r.blogspot.com/}

Da es an Dokumentation jedoch ein bisschen mangelt, die Informationen in
Foren verstreut sind und nicht jeder die Zeit hat, sich mittels "<Trial
and Error"> einzuarbeiten, entstand dieser Guide, um den Einstieg etwas
zu erleichtern. Eigentlich ist das schon die zweite Anleitung dieser
Art, denn bereits von eineinhalb Jahren habe ich eine solche
geschrieben. Bis vor kurzem war sie noch zu gebrauchen, aber Anfang
April 2009 gab es dann einen etwas größeren Sprung in der Entwicklung,
sodass spätestens jetzt eine Aktualisierung notwendig wurde.

Es sei angemerkt, dass dies keine offizielle Dokumentation ist. Dennoch
will ich versuchen, die Vorgänge so genau wie möglich darzustellen und
auf möglichst alle Optionen einzugehen.

\subsection{Installation}
Die Installation gestaltet sich denkbar einfach: Man besucht \deltor's
Blog, sucht den jeweils aktuellen Link und lädt eine Datei namens
\texttt{Physics.jar} herunter. Diese Datei muss dann in den Unterordner
\texttt{Plugins} des \aoi-Verzeichnisses kopiert werden. Fertig.

Um die Version 0.6.6 nutzen zu können, sollte man am besten \aoi
in der Version 2.7.2 verwenden. Für den Fall, dass \aoi noch gar nicht
installiert ist, kann man es sich unter folgender URL herunterladen:

\url{http://www.artofillusion.org}

\subsection{Funktion und Einsatzzweck der Simulation}
Wie der Name schon vermuten lässt, ist der primäre Zweck, Flüssigkeiten
zu simulieren. Diese entstehen in sogenannten \fachb{Emitters} und
interagieren dann mit als \fachb{Boundary} definierten Objekten in der
Szene.\footnote{Dem Plugin fehlt noch eine deutsche Übersetzung, daher
werde ich mich hier an die englischen Begriffe halten, um Verwirrung zu
vermeiden. Sollte der eine oder andere Begriff Probleme bereiten, dann
findet sich hier ein erstklassiges Online-Wörterbuch:
\url{http://dict.leo.org}} Alternativ kann man auch ganze Objekte
als \fachb{Fluid} vordefinieren, um auf einen Schlag viel Flüssigkeit in die
Szene zu bringen.

Mittlerweile beherrscht das Plugin jedoch auch die Simulation von
sogenannten \fachb{Soft Bodies}. Damit sind Körper gemeint, die im
Wesentlichen deformierbar sind. Man kann damit in gewissem Rahmen zwar
auch feste Körper simulieren, stößt aber bald an die Grenzen. Die Gründe
dafür werden später näher erläutert. Eine richtige Simulation starrer
Körper (\fachb{Rigid Bodies}) wird es erst in der Zukunft geben.

Das Plugin ist dabei auch tatsächlich eine \emph{Simulation}. Leider
steht das in einem gewissen Widerspruch zu dem "<Art"> in \aoi.
Simulationen versuchen, der Realität ähnlich zu sein, was zur Folge hat,
dass man sie nur sehr schwer kontrollieren kann. Es ist beispielsweise
nicht möglich, das Anstoßen zweier Bierkrüge, von denen der Inhalt des
einen in den anderen überschwappt, so darzustellen, wie man es sich
gedanklich vorstellen würde. Stattdessen muss eine Animation erstellt
werden, welche die Bierkrüge im Vorfeld genau so bewegt, dass die in
ihnen enthaltene Flüssigkeit dann auch tatsächlich im richtigen Moment
"<schwappt">.  Das ist nicht einfach, da sich die Flüssigkeit
realitätsgetreu verhält und man die Krüge nicht mit den Händen
\emph{anfassen} kann. Dadurch wird das Einschätzen der vorhandenen
Massen und wirkenden Kräfte zu keiner leichten Aufgabe.

Auf der anderen Seite ist aber genau das die Herausforderung.

Abgesehen von den künstlerischen Aspekten bietet die Simulation
natürlich eine großartige Spielwiese. Es macht einfach Spaß, einen Turm
aus Kisten zu bauen und dann zuzusehen, wie dieser durch Wasser
weggespült wird. Oder die Simulation einer Kegelbahn. Oder nachgebildete
Hydraulik, die vielleicht sogar einem kleinen Roboter Leben einhaucht.
Oder die realitätsgetreue Darstellung von Kleidung und Stoffen...

Ein bisschen Zukunftsmusik ist in diesen Beispielen allerdings noch
enthalten: Im Moment beherrscht das Plugin noch keine Reibung.

Nichtsdestotrotz: Viel Spaß!

\pagebreak
\section{Grundlagen}
\subsection{Animationen und \fachb{Baking}}
In der Einleitung fiel bereits das entscheidende Stichwort: Animation.
Die \fluidsim beschreibt Vorgänge, die sich zusammen mit der Zeit
verändern. Man kommt also nicht umhin, eine Animation zu erstellen
-- auch, wenn man am Ende nur ein einzelnes Bild rendern möchte. Das
wäre zwar keine allzu schwere Arbeit (Animation ist eine der
Hauptaufgaben von \aoi), aber die \fluidsim nimmt sie uns großteils
sogar ab. Das Minimum ist jedoch, sich die \emph{Zeitleiste} zugänglich
zu machen. Im Normalfall muss man dazu nichts weiter tun, als den Rand
am unteren Ende des \aoi-Hauptfensters mit der Maus ein Stück nach oben
zu ziehen.

\addpic{Zeitleiste}

Mit dieser Leiste ist es möglich, innerhalb einer Animation zu
navigieren.

Da die Berechnungen, welche die \fluidsim anstellt, ziemlich aufwändig
sind, können sie nicht in Echtzeit erfolgen. Die Simulation muss also
vor dem eigentlichen Rendern vorberechnet werden. Dieser Vorgang wird
\fachb{Baking} genannt und wird aus dem Plugin heraus angestoßen. Erst
hiernach hat es auch wirklich eine Auswirkung, wenn man den aktuellen
Zeitpunkt in der Zeitleiste verändert, und die Objekte bewegen sich.

Die Daten werden dabei in einer Datei zwischengespeichert. Man sollte
hier nicht zu geizig sein und sich mit einem fast vollen Datenträger
begnügen: Diese Datei kann bei langen Simulationen mehrere hundert
Megabyte groß werden.

\subsection{Zeitschritte und Partikelgrößen}
Eine physikalische Simulation läuft am Computer immer "<diskretisiert">
ab, das heißt, es gibt nur eine endliche Anzahl fester Zeitpunkte, die
berechnet werden. Dazwischen gibt es zwangsweise "<Lücken">. Daraus
folgt natürlich, dass eine Simulation dann genauer wird, wenn diese
Zeitpunkte näher beeinander liegen. Der Abstand zweier solcher
Zeitpunkte wird im Plugin \fachb{Step Size} genannt.

Man muss hier einen guten Kompromiss finden: Ist die Step Size zu groß,
dann ist die Simulation zwar sehr schnell berechnet, aber höchst
ungenau. Es kann dann passieren, dass Flüssigkeitspartikel ihre
Hindernisse "<überspringen">. Wird die Step Size dagegen zu klein
gewählt, dauert es einfach zu lange, bis der Baking-Vorgang beendet
ist.\footnote{Eine schöne Anekdote zu diesem Thema findet sich übrigens
hier: \url{http://xkcd.com/505/}}

\addpic{Partikel überspringt Hindernis}

Die Flüssigkeiten werden intern als kleine Partikel fester Größe
modelliert, anhand des Parameters \fachb{Particle Size}. Wie man schon
erahnen kann, gilt hier ein ähnlicher Zusammenhang: Sind die Partikel
sehr klein, dann ist die Simulation sehr detailliert, aber langsam. Sind
sie zu groß, simuliert man irgendwann Fußbälle.

Bei beiden Parametern sind Werte voreingestellt, die für einfache
Beispiele ausreichend sind.

\subsection{\fachb{Selection Sets} zur Gruppierung}
Mit Version 0.6.6 der \fluidsim wurde eine Integration mit dem
Selections-Plugin von \aoi geschaffen. Das ist insofern eine große
Vereinfachung, als damit massenhaft Objekten Werte zugeordnet werden
können. Außerdem wird die Übersicht erheblich erhöht. Daher lohnt es
sich, einen kurzen Blick auf dieses Plugin zu werfen. Falls es noch
nicht installiert ist, kann es über den Scripts and Plugins Manager
leicht nachinstalliert werden.

Die Grundidee des Selections-Plugins ist es, Objekte in logischen
Gruppen zusammenzufassen. Es kann noch ein bisschen mehr, zum Beispiel
Locking oder Ausblenden der Objekte, die für unseren Zweck aber nicht
ganz so interessant sind -- und überdies selbst\-er\-klä\-rend.

Die Bedienung ist recht einfach: Die Objekte, die man zusammenfassen
will, markiert man und klickt dann unter "<Selections"> auf "<New">. Das
erstellt eine neue Gruppe, die automatisch all diese Objekte enthält. Da
jedoch nicht ganz offensichtlich ist, dass dies der Fall ist, kann mit
einem Doppelklick auf den Namen des Selection Sets ein neues
Dialogfenster mit einer Übersicht öffnen. In diesem neuen Dialog können
auch Objekte aus der Gruppe herausgenommen werden. Genauer gesagt: Was
hier markiert ist, gehört zur Gruppe.

Ein möglicher Anwendungsfall: Man hat sehr viele Kisten und möchte diese
später alle auf die gleiche Weise als Soft Body verwenden. Dazu fasst
man sie vorab zu einem Selection Set zusammen.


\pagebreak
\section{Flüssigkeitssimulation}
einfach mal ein Beispiel durchgehen, möglichst viele Optionen
besprechen.


\pagebreak
\section{Simulation deformierbarer Körper}
dito... Feder-Masse-System und so


\pagebreak
\section{Texturieren und Rendern}
Raster-Renderer empfehlen, Grid für den Raytracer


\end{document}

% vim: set tw=72 :
